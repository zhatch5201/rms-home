{"ast":null,"code":"\"use strict\";\n/*!\n * Copyright 2019 Google Inc. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar _createForOfIteratorHelper = require(\"C:/Users/Zack/Desktop/rms-home/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createForOfIteratorHelper\");\n\nvar _classCallCheck = require(\"C:/Users/Zack/Desktop/rms-home/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"C:/Users/Zack/Desktop/rms-home/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass\");\n\nvar _get = require(\"C:/Users/Zack/Desktop/rms-home/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/get\");\n\nvar _getPrototypeOf = require(\"C:/Users/Zack/Desktop/rms-home/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/getPrototypeOf\");\n\nvar _inherits = require(\"C:/Users/Zack/Desktop/rms-home/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/inherits\");\n\nvar _createSuper = require(\"C:/Users/Zack/Desktop/rms-home/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createSuper\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ResourceStream = void 0;\n\nvar stream_1 = require(\"stream\");\n\nvar ResourceStream = /*#__PURE__*/function (_stream_1$Transform) {\n  _inherits(ResourceStream, _stream_1$Transform);\n\n  var _super = _createSuper(ResourceStream);\n\n  function ResourceStream(args, requestFn) {\n    var _this;\n\n    _classCallCheck(this, ResourceStream);\n\n    var options = Object.assign({\n      objectMode: true\n    }, args.streamOptions);\n    _this = _super.call(this, options);\n    _this._ended = false;\n    _this._maxApiCalls = args.maxApiCalls === -1 ? Infinity : args.maxApiCalls;\n    _this._nextQuery = args.query;\n    _this._reading = false;\n    _this._requestFn = requestFn;\n    _this._requestsMade = 0;\n    _this._resultsToSend = args.maxResults === -1 ? Infinity : args.maxResults;\n    return _this;\n  }\n  /* eslint-disable  @typescript-eslint/no-explicit-any */\n\n\n  _createClass(ResourceStream, [{\n    key: \"end\",\n    value: function end() {\n      var _get2;\n\n      this._ended = true;\n\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      return (_get2 = _get(_getPrototypeOf(ResourceStream.prototype), \"end\", this)).call.apply(_get2, [this].concat(args));\n    }\n  }, {\n    key: \"_read\",\n    value: function _read() {\n      var _this2 = this;\n\n      if (this._reading) {\n        return;\n      }\n\n      this._reading = true; // Wrap in a try/catch to catch input linting errors, e.g.\n      // an invalid BigQuery query. These errors are thrown in an\n      // async fashion, which makes them un-catchable by the user.\n\n      try {\n        this._requestFn(this._nextQuery, function (err, results, nextQuery) {\n          if (err) {\n            _this2.destroy(err);\n\n            return;\n          }\n\n          _this2._nextQuery = nextQuery;\n\n          if (_this2._resultsToSend !== Infinity) {\n            results = results.splice(0, _this2._resultsToSend);\n            _this2._resultsToSend -= results.length;\n          }\n\n          var more = true;\n\n          var _iterator = _createForOfIteratorHelper(results),\n              _step;\n\n          try {\n            for (_iterator.s(); !(_step = _iterator.n()).done;) {\n              var result = _step.value;\n\n              if (_this2._ended) {\n                break;\n              }\n\n              more = _this2.push(result);\n            }\n          } catch (err) {\n            _iterator.e(err);\n          } finally {\n            _iterator.f();\n          }\n\n          var isFinished = !_this2._nextQuery || _this2._resultsToSend < 1;\n          var madeMaxCalls = ++_this2._requestsMade >= _this2._maxApiCalls;\n\n          if (isFinished || madeMaxCalls) {\n            _this2.end();\n          }\n\n          if (more && !_this2._ended) {\n            setImmediate(function () {\n              return _this2._read();\n            });\n          }\n\n          _this2._reading = false;\n        });\n      } catch (e) {\n        this.destroy(e);\n      }\n    }\n  }]);\n\n  return ResourceStream;\n}(stream_1.Transform);\n\nexports.ResourceStream = ResourceStream;","map":{"version":3,"sources":["C:/Users/Zack/Desktop/rms-home/node_modules/@google-cloud/paginator/build/src/resource-stream.js"],"names":["Object","defineProperty","exports","value","ResourceStream","stream_1","require","args","requestFn","options","assign","objectMode","streamOptions","_ended","_maxApiCalls","maxApiCalls","Infinity","_nextQuery","query","_reading","_requestFn","_requestsMade","_resultsToSend","maxResults","err","results","nextQuery","destroy","splice","length","more","result","push","isFinished","madeMaxCalls","end","setImmediate","_read","e","Transform"],"mappings":"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","sourcesContent":["\"use strict\";\n/*!\n * Copyright 2019 Google Inc. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ResourceStream = void 0;\nconst stream_1 = require(\"stream\");\nclass ResourceStream extends stream_1.Transform {\n    constructor(args, requestFn) {\n        const options = Object.assign({ objectMode: true }, args.streamOptions);\n        super(options);\n        this._ended = false;\n        this._maxApiCalls = args.maxApiCalls === -1 ? Infinity : args.maxApiCalls;\n        this._nextQuery = args.query;\n        this._reading = false;\n        this._requestFn = requestFn;\n        this._requestsMade = 0;\n        this._resultsToSend = args.maxResults === -1 ? Infinity : args.maxResults;\n    }\n    /* eslint-disable  @typescript-eslint/no-explicit-any */\n    end(...args) {\n        this._ended = true;\n        return super.end(...args);\n    }\n    _read() {\n        if (this._reading) {\n            return;\n        }\n        this._reading = true;\n        // Wrap in a try/catch to catch input linting errors, e.g.\n        // an invalid BigQuery query. These errors are thrown in an\n        // async fashion, which makes them un-catchable by the user.\n        try {\n            this._requestFn(this._nextQuery, (err, results, nextQuery) => {\n                if (err) {\n                    this.destroy(err);\n                    return;\n                }\n                this._nextQuery = nextQuery;\n                if (this._resultsToSend !== Infinity) {\n                    results = results.splice(0, this._resultsToSend);\n                    this._resultsToSend -= results.length;\n                }\n                let more = true;\n                for (const result of results) {\n                    if (this._ended) {\n                        break;\n                    }\n                    more = this.push(result);\n                }\n                const isFinished = !this._nextQuery || this._resultsToSend < 1;\n                const madeMaxCalls = ++this._requestsMade >= this._maxApiCalls;\n                if (isFinished || madeMaxCalls) {\n                    this.end();\n                }\n                if (more && !this._ended) {\n                    setImmediate(() => this._read());\n                }\n                this._reading = false;\n            });\n        }\n        catch (e) {\n            this.destroy(e);\n        }\n    }\n}\nexports.ResourceStream = ResourceStream;\n//# sourceMappingURL=resource-stream.js.map"]},"metadata":{},"sourceType":"script"}